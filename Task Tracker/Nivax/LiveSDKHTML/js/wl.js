(function(){if(!window.WL){var Yf="download",p="interface_method",Pe="WL.Internal.jsonp.",sf=2000,Gc="body",B="callback",Hc="code",Df="element",Cc="error",mf="error_description",tc="logging",Xd="tracing",uc="message",C="method",oc="file_input",Ed="stream_input",gb="file_name",eb="file_output",q="overwrite",u="path",ge="pretty",If="result",Jf="status",Dd="return_ssl_resources",wf="success",Kf="error",wd="suppress_redirects",Tb="suppress_response_codes",z="x_http_live_library",Dc=0,dc=1,c="access_token",bg="appstate",w="authentication_token",Nc="client_id",eg="display",Je="code",k="error",kb="error_description",Rc="expires",Kc="expires_in",gg="locale",Bc="redirect_uri",ee="response_type",Rf="request_ts",l="scope",Be="session",fe="secure_cookie",Vc="state",F="status",Pf=[c,w,l,Kc,Rc],L="connected",le="notConnected",Zf="unchecked",mb="unknown",ze="expiring",fg="expired",Ec="live-sdk-upload",vc="live-sdk-download",hg="appId",Tf="channelUrl",cg="wl_auth",Uf="wl_upload",dg="app",Vf="popup",xe="page",Wf="touch",M="none",Lf="none",Cb="auth.login",Ab="auth.logout",tb="auth.sessionChange",bc="auth.statusChange",Uc="wl.log",J="access_denied",ef="connection_failed",yf="invalid_cookie",jc="invalid_request",Bb="request_canceled",f="request_failed",pe="timed_out",xb="unknown_user",tf="user_canceled",Ze="METHOD: Failed to get the required user permission to perform this operation.",af="The request could not be completed due to browser issues.",bf="The request could not be completed due to browser limitations.",zb="METHOD: The operation has been canceled.",We="The 'wl_auth' cookie is not valid.",Ve="The 'wl_auth' cookie has been modified incorrectly. Ensure that the redirect URI only modifies sub-keys for values received from the OAuth endpoint.",Re="The 'wl_auth' cookie has multiple values. Ensure that the redirect URI specifies a cookie domain and path when setting cookies.",zd="METHOD: The input parameter 'PARAM' does not reference a valid DOM element.",Id="METHOD: An exception was received for EVENT. Detail: MESSAGE",Ad="METHOD: The WL object must be initialized with WL.init() prior to invoking this method.",ud="A connection to the server could not be established.",Ue="The user could not be identified.",ff="The pending login request has been canceled.",fd="Logging out the user is not supported in current session because the user is logged in with a Microsoft account on this computer. To logout, the user may quit the app or log out from the computer.",qd="METHOD: The input parameter 'PARAM' is not valid.",rd="METHOD: The input parameter 'PARAM' must be included.",gd="METHOD: The type of the provided value for the input parameter 'PARAM' is not valid.",ob="METHOD: There is a pending METHOD request, the current call will be ignored.",Qb=ob.replace(/METHOD/g,"WL.login"),Ne=ob.replace(/METHOD/g,"WL.fileDialog"),Qe=ob.replace(/METHOD/g,"WL.upload"),Te="METHOD: The input parameter 'redirect_uri' is required if the value of the 'response_type' parameter is 'code'.",bd="WL.init: The redirect_uri value should be the same as the value of 'Redirect Domain' on API Settings page of your app on https://manage.dev.live.com. It must begin with 'http://' or 'https://'.",Se="METHOD: The api call is not supported on this platform.",Zc="WL.init: The response_type value 'code' is not supported on this platform.",zf="METHOD: The input parameter 'redirect_uri' must use https: to match the scheme of the current page.",cf="The auth request is timed out.",hf="The popup is closed without receiving consent.",Ef=0,Xe=1,df=2,Af=3,ib="GET",ie="POST",ne="PUT",Td="DELETE",Mf="COPY",Nf="MOVE",gf=30000,Le="METHOD",h="onSuccess",m="onError",o="onProgress",Xf="redirect_type",Bf="auth",pf="upload",Cf="code",uf="token",Lb="https:",Nb="http:",E="wl.signin",Qf="wl.skydrive",kf="wl.skydrive_update",xc=/\s|,/,lb="boolean",Ie="dom",e="function",Ae="number",b="string",P="object",yb="string_or_array",Jc="undefined",we="name",Db="element",K="brand",Jb="type",db="sign_in_text",bb="sign_out_text",W="theme",qc="onloggedin",mc="onloggedout",Eb="onerror",Wd="messenger",ke="hotmail",de="skydrive",Ac="windows",qf="windowslive",X="none",Pb="signin",vb=Pb,nc="login",hc="connect",kc="custom",rf="blue",lf="white",fb="dark",Hd="light",Of="id",Y="sdk_root",ig="wl_trace",y={name:B,type:e,optional:true},nd={name:B,type:e,optional:false};window.WL={getSession:function(){try{return a.getSession()}catch(b){R(b.message)}},getLoginStatus:function(){try{return a.getLoginStatus({callback:sc(arguments,e,2),internal:false},sc(arguments,lb,2))}catch(d){return I("WL.getLoginStatus",d)}},logout:function(b){try{jb(b,y,"WL.logout");return a.logout({callback:b})}catch(c){return I("WL.logout",c)}},canLogout:function(){return a.canLogout()},api:function(){try{var c=Fd(arguments);n(c,[{name:u,type:b,optional:false},{name:C,type:b,optional:true},y],"WL.api");return a.api(c)}catch(f){return I("WL.api",f)}}};var Lc=[Cb,Ab,tb,bc,Uc];WL.Event={subscribe:function(c,a){try{jb([c,a],[{name:"event",type:b,allowedValues:Lc,caseSensitive:true,optional:false},nd],"WL.Event.subscribe");d.subscribe(c,a)}catch(e){R(e.message)}},unsubscribe:function(c,a){try{jb([c,a],[{name:"event",type:b,allowedValues:Lc,caseSensitive:true,optional:false},y],"WL.Event.unsubscribe");d.unsubscribe(c,a)}catch(e){R(e.message)}}};WL.Internal={};function U(i,h){var f=Tc(i),a=null,b=null;for(var d=0;d<f.length;d++){var c=f[d],g=typeof c;if(g===P&&a===null)a=N(c);else if(g===e&&b===null)b=c}a=a||{};if(b)a.callback=b;a[p]=h;return a}function Fd(e){var a=Tc(e),d=null,c=null;if(typeof a[0]===b){d=a.shift();if(typeof a[0]===b)c=a.shift()}normalizedArgs=U(a);if(d!==null){normalizedArgs[u]=d;if(c!=null)normalizedArgs[C]=c}return normalizedArgs}function I(a,b){var c=ub(a,a,b);R(b.message);return cb(a,false,null,c)}var d={subscribe:function(a,b){x("Subscribe "+a);var c=d.getHandlers(a);c.push(b)},unsubscribe:function(c,f){x("Unsubscribe "+c);var b=d.getHandlers(c),e=[];if(f!=null){var g=false;for(var a=0;a<b.length;a++)if(g||b[a]!=f)e.push(b[a]);else g=true}d._eHandlers[c]=e},getHandlers:function(b){if(!d._eHandlers)d._eHandlers={};var a=d._eHandlers[b];if(a==null)d._eHandlers[b]=a=[];return a},notify:function(c,e){x("Notify "+c);var b=d.getHandlers(c);for(var a=0;a<b.length;a++)b[a](e)}},a={_status:Dc,_statusRequests:[]};a.appInit=function(b){if(a._status==dc)return;var c=WL[Y];if(c){if(c.charAt(c.length-1)!=="/")c+="/";a[Y]=c}var d=b[tc];if(d===false)a._logEnabled=d;a._authScope=Od(b[l]);a._secureCookie=Gd(b[fe]);a._status=dc;if(a.testInit)a.testInit(b);td(b)};a.onloadInit=function(){oe();se()};function t(b){if(a._status===Dc)throw new Error(Ad.replace("METHOD",b))}function Ob(){return WL.Internal.tApp||a}a.api=function(a){t("WL.api");var c=a[Gc];if(c){a=N(Gb(c),a);delete a[Gc]}var b=a[C];a[C]=(b!=null?Q(b):ib).toUpperCase();return (new Sc(a)).execute()};var Jd=function(){var b=a.api.lastId,c;b=b===undefined?1:b+1;c="WLAPI_REQ_"+b+"_"+(new Date).getTime();a.api.lastId=b;return c},Sc=function(b){var c=this;c._properties=b;c._completed=false;c._id=Jd();b[ge]=false;b[Dd]=a._isHttps;b[z]=a[z];var d=b[u];c._url=zc()+(d.charAt(0)==="/"?d.substring(1):d);c._promise=new g("WL.api",null,null)};Sc.prototype={execute:function(){ae(this);return this._promise},onCompleted:function(a){if(this._completed)return;this._completed=true;j(this._properties.callback,a,true);if(a[k])this._promise[m](a);else this._promise[h](a)}};function Ud(e,c,a,d){a=a?Q(a):"";var b=a!==""?Fc(a):null;if(b===null){b={};if(c/100!==2)b[Cc]=Zd(c,d)}e.onCompleted(b)}function Zd(c,b){var a={};a[Hc]=f;a[uc]=b||ud;return a}function lc(){var b=null,a=Ob()._session.getStatus();if(a.status===ze||a.status===L)b=a.session[c];return b}function Gb(i){var c={};for(var b in i){var a=i[b],j=typeof a;if(a instanceof Array)for(var d=0;d<a.length;d++){var f=a[d],l=typeof f;if(j==P&&!(a instanceof Date)){var h=Gb(f);for(var e in h)c[b+"."+d+"."+e]=h[e]}else c[b+"."+d]=f}else if(j==P&&!(a instanceof Date)){var k=Gb(a);for(var g in k)c[b+"."+g]=k[g]}else c[b]=a}return c}function Kd(c){if(!Ge())return false;var b=ce(c),a=new XMLHttpRequest;a.open(b.method,b.url,true);var d=c._properties[C];if(b.method!=ib)a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.onreadystatechange=function(){if(a.readyState==4)Ud(c,a.status,a.responseText)};a.send(b.body);return true}function ce(e){var a=Yd(e._properties,null,[B,u,C]),f=e._properties[C],g=pc(e._url,{"ts":(new Date).getTime()}),h=lc(),d,b;a[wd]="true";a[Tb]="true";if(h!=null)a[c]=h;if(f===ib||f===Td){d=null;b=ib;g+="&"+wb(a)}else{d=wb(a);b=ie}g+="&method="+f;return {url:g,method:b,body:d}}a.download=function(a){md(a);t("WL.download");return (new wc(a)).execute()};function ec(b,f){var d=f||{},g=zc();if(!Ib(b))b=g+(b.charAt(0)==="/"?b.substring(1):b);var e=lc();if(e)d[c]=e;d[z]=a[z];return pc(b,d)}function Vb(a,b){b.downloadComplete(false,r(f,"WL.download: "+a))}var Ub="notStarted",fc="ready",nb="downloadCompleted",Sb="downloadFailed",Wb="canceled",ld="completed";function wc(a){this._properties=a;this._status=Ub}wc.prototype={execute:function(){this._promise=new g("WL.download",this,null);this._process();return this._promise},cancel:function(){this._status=Wb;if(this._cancel)try{this._cancel()}catch(a){}else{this._result=r(Bb,zb.replace("METHOD","WL.download"));this._process()}},downloadComplete:function(b,c){var a=this;a._result=c;a._status=b?nb:Sb;a._process()},downloadProgress:function(a){this._promise[o](a)},_process:function(){switch(this._status){case Ub:this._start();break;case fc:this._download();break;case nb:case Sb:case Wb:this._complete()}},_start:function(){var b=this;a.getLoginStatus({internal:true,callback:function(){b._status=fc;b._process()}})},_download:function(){var a=this;me(a)},_complete:function(){var a=this,c=a._result,d=a._status===nb?h:m;a._status=ld;var b=a._properties[B];if(b)b(c);a._promise[d](c)}};a.login=function(b,d){t("WL.login");Nd(b);if(!Sd(d))return cb("WL.login",false,null,r(f,Qb));var c=a._session.tryGetResponse(b.normalizedScope);if(c!=null)return cb("WL.login",true,b.callback,c);a._pendingLogin=Rd(b,Bd);return a._pendingLogin.execute()};function Bd(c,b){a._pendingLogin=null;var d=b[k];if(d)H("WL.login: "+b[kb]);else j(c.callback,b,true)}function Od(b){var a=b||"";if(a instanceof Array)a=a.join(" ");return Q(a)}a.getSession=function(){t("WL.getSession");return a._session.getStatus()[Be]};a.getLoginStatus=function(b,f){t("WL.getLoginStatus");b=b||{};if(!f){var d=a._session.tryGetResponse();if(d)return cb("WL.getLoginStatus",true,b.callback,d)}x("wl_app:getLoginStatus");var e=a._statusRequests,c=null;if(!a._pendingStatusRequest){c=pd(b,od);a._pendingStatusRequest=c}e.push(b);if(c!=null)c.execute();return a._pendingStatusRequest._promise};function od(h,b){var f=a._statusRequests;a._pendingStatusRequest=null;x("wl_app:onGetLoginStatusCompleted");var d=b[k],e=false;while(f.length>0){var c=f.shift(),g=N(b);if(!d||c.internal)j(c.callback,g,true);if(!c.internal)e=true}if(d)if(e&&d!==pe)H("WL.getLoginStatus: "+b[kb]);else x("wl_app-onGetLoginStatusCompleted: "+b[kb])}a.logout=function(e){t("WL.logout");var c=new g("WL.logout",null,null),d=function(){var a=b.getNormalStatus();j(e.callback,a,false);c[h](a)},b=a._session;if(b.isSignedIn())if(a.canLogout()){b.updateStatus(mb);be(d)}else throw new Error(fd);else O(d);return c};function gc(c,b){R(b.message);var a=c[Eb];if(a)O(function(){error=ub("WL.ui","WL.ui",b),a(error)})}var D=function(c){var a=this;a._properties=c;var b=v(a,a.init);rc(b)};D.prototype={init:function(){var c=this,e=c._properties;if(c._inited===true)return;c._inited=true;try{c.validate();element=e[Db],(type=e[Jb],(callback=e[B],(signinText=e[db],signoutText=e[bb])));id(e);element=typeof element===b?Hb(e[Db]):element;c._element=element;type=type!=null?type:vb;if(type==vb){signinText=G.signIn;signoutText=G.signOut}else if(type==nc){signinText=G.login;signoutText=G.logout}else if(type==hc){signinText=G.connect;signoutText=G.signOut}c[db]=signinText;c[bb]=signoutText;ye(element,xd(e));var f=a._session.isSignedIn(),g=f?signoutText:signinText;c.updateUI(g,f);ed(c,element.childNodes[0]);d.subscribe(Cb,v(c,c.onLoggedIn));d.subscribe(Ab,v(c,c.onLoggedOut));a.getLoginStatus({internal:true});delete e[B];j(callback,e,false)}catch(h){gc(e,h)}},validate:function(){var a=this._properties;n(a,[{name:Db,type:Ie,optional:false},{name:Jb,allowedValues:[vb,nc,hc,kc],type:b,optional:true},{name:l,type:yb,optional:true},{name:Vc,type:b,optional:true},{name:qc,type:e,optional:true},{name:mc,type:e,optional:true},{name:Eb,type:e,optional:true}],"WL.ui-signin");Yc(a);var c=a[Jb];if(c==kc)n(a,[{name:db,type:b,optional:false},{name:bb,type:b,optional:false}],"WL.ui-signin")},fireEvent:function(b,c){var a=this._properties[b];if(a)a(c)},onClick:function(){if(this._element.childNodes.length==0){pb(this);return}if(a._session.isSignedIn()){if(a.canLogout())a.logout({})}else a.login(this._properties,true).then(function(){},function(a){this.fireEvent(Eb,a)});return false},onLoggedIn:function(a){this.updateUI(this[bb],true);this.fireEvent(qc,a)},onLoggedOut:function(a){this.updateUI(this[db],false);this.fireEvent(mc,a)}};function id(b){if(a._authScope&&a._authScope!=="")b[l]=a._authScope;if(!b[l])b[l]=E}function re(){return a[Y]}function Oc(){return re()+"images"}function S(d,a,c){a._handlers=a._handlers||{};var b=v(a,c);a._handlers[d]=b;return b}function T(b,a){return a._handlers[b]}a.upload=function(a){var c=a[p];t(c);n(a,[{name:u,type:b,optional:false},y],c);dd(a);vd(a);return (new Fb(a)).execute()};function vd(a){var b=a[oc],c=a[gb];if(b)a[gb]=c||b.name}function hd(a,d,e){var c=typeof d!==Jc,g=a.charAt(a.length-1)==="/";if(c&&!g)a+="/";var f=a,b={};if(c)f+=encodeURIComponent(d);if(e==="rename")b[q]="choosenewname";else b[q]=e;return sb(f,b)}function Fe(a){return /^(file|\/file)/.test(a.toLowerCase())}function sb(b,a){a=a||{};a[Tb]="true";return ec(b,a)}function dd(a){if(q in a){var c=a[p],d=a[q],f=typeof d,h=f===lb,e=f===b;if(!(h||e))throw A(q,c);if(e){var g=/^(true|false|rename)$/i.test(d);if(!g)throw Zb(q,c)}}else a[q]=false}var Xb=0,Yb=1,rb=2,qb=3,Z=4,cc=5,sd=6;function Fb(a){this._props=a;this._status=Xb}Fb.prototype={execute:function(){var a=this;a._strategy=a._getStrategy(a._props);a._promise=new g(a._props[p],a,null);a._process();return a._promise},cancel:function(){var a=this;a._status=cc;if(a._cancel)try{a._cancel()}catch(c){}else{var b=zb.replace(Le,a._props[p]);a._result=r(Bb,b);a._process()}},uploadProgress:function(a){this._promise[o](a)},uploadComplete:function(b,c){var a=this;a._result=c;a._status=b?qb:Z;a._process()},onErr:function(c){var a=this._props[p]+":"+c,b=r(f,a);this.uploadComplete(false,b)},onResp:function(a){a=a?Q(a):"";var b=a!==""?Fc(a):null;b=b||{};this.uploadComplete(b.error==null,b)},setFileName:function(a){this._props[gb]=a},_process:function(){switch(this._status){case Xb:this._start();break;case Yb:this._getUploadPath();break;case rb:this._upload();break;case qb:case Z:case cc:this._complete()}},_start:function(){var a=this;Ob().getLoginStatus({internal:true,callback:function(){a._status=Yb;a._process()}})},_getUploadPath:function(){var a=this,c=a._props,b=c[u];if(Ib(b)){a._uploadPath=sb(b);a._status=rb;a._process();return}Ob().api({path:b}).then(function(h){var d=h.upload_location;if(d){var e=c[gb],g=c[q];if(Fe(b))a._uploadPath=sb(d);else a._uploadPath=hd(d,e,g);a._status=rb}else{a._result=r(f,"WL.upload: Failed to get upload_location of the resource.");a._status=Z}a._process()},function(b){a._result=b;a._status=Z;a._process()})},_upload:function(){this._strategy.upload(this._uploadPath)},_complete:function(){var a=this,c=a._result,d=a._status===qb?h:m;a._status=sd;var b=a._props[B];if(b)b(c);a._promise[d](c)}};function Q(a){return a.replace(/^\s+|\s+$/g,"")}function N(b,d){var c=d||{};if(b!=null)for(var a in b)c[a]=b[a];return c}function Yd(e,d,b){var c=N(e,d);for(var a=0;a<b.length;a++)delete c[b[a]];return c}function Ce(d,e){var c=[],b={},a=function(d){for(var a=0;a<d.length;a++){arrElm=d[a];if(arrElm!=""&&!b[arrElm]){b[arrElm]=true;c.push(arrElm)}}};a(d);a(e);return c}function Tc(a){return Array.prototype.slice.call(a)}function v(b,a){return function(){if(typeof a===e)return a.apply(b,arguments)}}function Xc(a,e){a="[WL]"+a;var b=window.console;if(b&&b.log)switch(e){case "warning":b.warn(a);break;case "error":b.error(a);break;default:b.log(a)}var d=window.opera;if(d)d.postError(a);var c=window.debugService;if(c)c.trace(a)}function Ib(a){return a.indexOf("https://")===0||a.indexOf("http://")===0}function x(b){if(a._traceEnabled)Xc(b)}function H(b,c){if(a._logEnabled||a._traceEnabled)Xc(b,c);d.notify(Uc,b)}if(window.WL&&WL.Internal){WL.Internal.trace=x;WL.Internal.log=H}function R(a){H(a,"error")}function Hb(a){return document.getElementById(a)}function te(a,b){if(a)if(a.innerText)a.innerText=b;else{var c=document.createTextNode(b);a.innerHTML="";a.appendChild(c)}}function Me(a){N(Wc(a),this)}Me.prototype={toString:function(){var a=this;s=(a.scheme!=""?a.scheme+"//":"")+a.host+(a.port!=""?":"+a.port:"")+a.path;return s},resolve:function(){var a=this;if(a.scheme==""){var b=window.location.port,c=window.location.host;a.scheme=window.location.protocol;a.host=c.split(":")[0];a.port=b!=null?b:"";if(a.path.charAt(0)!="/")a.path=Pd(a.host,window.location.href,a.path)}}};function Wc(c){var e=c.indexOf(Lb)==0?Lb:c.indexOf(Nb)==0?Nb:"",h="",i="",f;if(e!="")var b=c.substring(e.length+2),a=b.indexOf("/"),g=a>0?b.substring(0,a):b,d=g.split(":"),h=d[0],i=d.length>1?d[1]:"",f=a>0?b.substring(a):"";else f=c;return {scheme:e,host:h,port:i,path:f}}function ue(a){return Wc(a.toLowerCase()).host}function Pd(e,b,h){var d=function(a,c){charIdx=b.indexOf(c);a=charIdx>0?a.substring(0,charIdx):a;return a};b=d(d(b,"?"),"#");var f=b.indexOf(e),a=b.substring(f+e.length),g=a.indexOf("/"),c=a.lastIndexOf("/");a=c>=0?a.substring(g,c):a;return a+"/"+h}function j(a,b,d,c){if(a!=null){if(c)b[Vc]=c;if(d)a(b);else O(function(){a(b)})}}function Fc(a){if(window.JSON)return JSON.parse(a);else return eval("("+a+")")}function Ke(b,c){var d=b.length;for(var a=0;a<d;a++)c(b[a])}function hb(c,b){var a={};a[k]=c;a[kb]=b;return a}function r(d,c){var a={},b={};a[Hc]=d,a[uc]=c;b[Cc]=a;return b}function ub(a,b,c){return r(f,Id.replace("METHOD",a).replace("EVENT",b).replace("MESSAGE",c.message))}function Cd(b){var a=b.split(".");return a[0]+"."+a[1]}function O(a,b){if(window.wlUnitTests)wlUnitTests.delayInvoke(a);else window.setTimeout(a,b||1)}function oe(){var b=qe(navigator.userAgent,document.documentMode),c=a[z];a._browser=b;a[z]=c.replace("DEVICE",b.device)}function qe(a,e){a=a.toLowerCase();var c="other",b={"firefox":/firefox/.test(a),"firefox1.5":/firefox\/1\.5/.test(a),"firefox2":/firefox\/2/.test(a),"firefox3":/firefox\/3/.test(a),"firefox4":/firefox\/4/.test(a),"ie":/msie/.test(a)&&!/opera/.test(a),"ie6":false,"ie7":false,"ie8":false,"ie9":false,"ie10":false,"opera":/opera/.test(a),"webkit":/webkit/.test(a),"chrome":/chrome/.test(a),"mobile":/mobile/.test(a)||/phone/.test(a)};if(b["ie"]){var d=0;if(e)d=e;else if(/msie 7/.test(a))d=7;d=Math.min(10,Math.max(d,6));c="ie"+d;b[c]=true}else if(b.firefox)c="firefox";else if(b.chrome)c="chrome";else if(b.webkit)c="webkit";else if(b.opera)c="opera";if(b.mobile)c+="mobile";b.device=c;return b}function wb(b){var a="";if(b!=null)for(var c in b){var d=a.length==0?"":"&",e=b[c];a+=d+encodeURIComponent(c)+"="+encodeURIComponent(Qd(e))}return a}function Qd(a){if(a instanceof Date){var b=function(a,b){switch(b){case 2:return a<10?"0"+a:a;case 3:return (a<10?"00":a<100?"0":"")+a}};return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1,2)+"-"+b(a.getUTCDate(),2)+"T"+b(a.getUTCHours(),2)+":"+b(a.getUTCMinutes(),2)+":"+b(a.getUTCSeconds(),2)+"."+b(a.getUTCMilliseconds(),3)+"Z"}return ""+a}function pc(a,b){return a+(a.indexOf("?")<0?"?":"&")+wb(b)}function Gd(a){switch(typeof a){case lb:return a;case Ae:return !!a;case b:return a.toLowerCase()==="true";default:return false}}function jb(a,c,d){if(a instanceof Array)for(var b=0;b<a.length;b++)Mc(a[b],c[b],d);else Mc(a,c,d)}function Mc(c,a,b){yc(c,a,b);if(a.type==="properties")n(c,a.properties,b)}function yc(g,f,c){var d=f.name,a=typeof g,h=f.type;if(a==="undefined"||g==null)if(f.optional)return;else throw ac(d,c);switch(h){case "string":case "url":if(a!==b)throw A(d,c);if(!f.optional&&Q(g)==="")throw ac(d,c);break;case "properties":if(a!=P)throw A(d,c);break;case "function":if(a!=e)throw A(a,c);break;case "dom":if(a==b){if(Hb(g)==null)throw new Error(zd.replace("METHOD",c).replace("PARAM",d))}else if(a!=P)throw A(d,c);break;case "string_or_array":if(a!==b&&!(g instanceof Array))throw A(a,c);break;default:if(a!==h)throw A(d,c)}if(f.allowedValues!=null)Ld(g,f.allowedValues,f.caseSensitive,d,c)}function n(g,c,f){var d=g||{};for(var b=0;b<c.length;b++){var a=c[b],e=d[a.name]||d[a.altName];yc(e,a,f)}}function Ld(d,a,e,f,h){var g=typeof a[0]===b;for(var c=0;c<a.length;c++)if(g&&!e){if(d.toLowerCase()===a[c].toLowerCase())return}else if(d===a[c])return;throw Zb(f,h)}function A(a,b){return new Error(gd.replace("METHOD",b).replace("PARAM",a))}function ac(a,b){return new Error(rd.replace("METHOD",b).replace("PARAM",a))}function Zb(c,d,a){var b=qd.replace("METHOD",d).replace("PARAM",c);if(typeof a!==Jc)b+=" "+a;return new Error(b)}function sc(b,d,c){if(b)for(var a=0;a<c&&a<b.length;a++)if(d===typeof b[a])return b[a];return undefined}var g=function(b,c,a){this._name=b;this._op=c;this._uplinkPromise=a;this._isCompleted=false;this._listeners=[]};g.prototype={then:function(d,e,c){var b=new g(null,null,this),a={};a[h]=d;a[m]=e;a[o]=c;a.chainedPromise=b;this._listeners.push(a);return b},cancel:function(){if(this._isCompleted)return;if(this._uplinkPromise&&!this._uplinkPromise._isCompleted)this._uplinkPromise.cancel();else{var a=this._op?this._op.cancel:null;if(typeof a===e)this._op.cancel();else this.onError(r(Bb,zb.replace("METHOD",this._getName())))}},_getName:function(){if(this._name)return this._name;if(this._op&&typeof this._op._getName===e)return this._op._getName();if(this._uplinkPromise)return this._uplinkPromise._getName();return ""},_onEvent:function(b,a){if(this._isCompleted)return;this._isCompleted=a!==o;this._notify(b,a)},_notify:function(b,a){var c=this;Ke(this._listeners,function(g){var i=g[a],d=g.chainedPromise,f=a!==o;if(i)try{var e=i.apply(g,b);if(f&&e&&e.then){d._op=e;e.then(function(a){d[h](a)},function(a){d[m](a)},function(a){d[o](a)})}}catch(j){if(f)d.onError(ub(c._getName(),a,j))}else if(f)d[a].apply(d,b)})}};g.prototype[h]=function(){this._onEvent(arguments,h)};g.prototype[m]=function(){this._onEvent(arguments,m)};g.prototype[o]=function(){this._onEvent(arguments,o)};function cb(f,d,b,i){var a=new g(f,null,null),c=d?h:m;if(typeof b===e)a.then(function(a){b(a)});O(function(){a[c](i)});return a}var Pf=[c,w,l,Kc,Rc],Ic="apiservice_uri",Pc="auth_server",Oe=-2147023579,ve="///LiveSDKHTML/",V="ms-resource:///WLText/",G=null;WL.init=function(c){try{var b=N(c);jb(b,{name:"properties",type:"properties",optional:false,properties:[{name:l,type:yb,optional:true},{name:Bc,type:"url",optional:true},{name:tc,type:lb,optional:true}]},"WL.init");a.appInit(b)}catch(d){R(d.message)}};WL.login=function(){try{var b=U(arguments);n(b,[{name:l,type:yb,optional:true},y],"WL.login");return a.login(b)}catch(e){return I("WL.login",e)}};WL.backgroundDownload=function(){try{var b="WL.backgroundDownload",c=U(arguments,b);return a.download(c)}catch(f){return I(b,f)}};WL.backgroundUpload=function(){try{var b="WL.backgroundUpload",c=U(arguments,b);return a.upload(c)}catch(f){return I(b,f)}};WL.ui=function(){try{var d="WL.ui",c=U(arguments,d);n(c,[{name:we,type:b,allowedValues:[Pb],optional:false},y],d);a.ui(c)}catch(g){gc(c,g)}};function td(b){if(b[ee]===Je)throw new Error(Zc);a._isHttps=true;a._authScope=yd(a._authScope);if(b[Xd])a._traceEnabled=true;if(!a[Y])a[Y]=ve;a._domain=Vd(b);Ee();var c=Windows.Security.Authentication.Web.WebAuthenticationBroker.getCurrentApplicationCallbackUri().absoluteUri;b[Nc]=c;ad();a._session=new Qc(c);a.getLoginStatus({internal:true})}function Vd(c){var a=c[Bc],b=null;if(a!=null)if(a.indexOf(Nb)===0||a.indexOf(Lb)===0)b=ue(a);else throw new Error(bd);return b}function Ee(){try{var c=Windows.ApplicationModel.Resources.Core,e=c.ResourceManager,d=e.current.defaultContext.languages[0],b=c.ResourceManager.current.mainResourceMap;a._locale=(d||"en").toLowerCase();G={signIn:b.getValue(V+"signIn").valueAsString,signOut:b.getValue(V+"signOut").valueAsString,login:b.getValue(V+"login").valueAsString,logout:b.getValue(V+"logout").valueAsString,connect:b.getValue(V+"connect").valueAsString}}catch(f){H(f.message)}}function se(){a._logEnabled=true;a._traceEnabled=false;rc(function(){var a=window.wlAsyncInit;if(a&&typeof a===e)a.call()})}function yd(a){a=a||E;if(a.indexOf(E)<0)a=a+" "+E;return Q(a)}function ad(){var b=Windows.Networking.BackgroundTransfer,a=function(a){try{var b=a.attachAsync().then(function(){},function(){},function(){})}catch(c){}};b.BackgroundDownloader.getCurrentDownloadsAsync(vc).then(function(b){if(b&&b.size>0)for(i=0;i<b.size;i++)a(b[i])});b.BackgroundUploader.getCurrentUploadsAsync(Ec).then(function(b){if(b&&b.size>0)for(i=0;i<b.size;i++)a(b[i])})}function Sd(c){var b=a._pendingLogin;if(b!=null){if(!c)H(Qb);return false}return true}function Nd(d){var c=d[l]||[],e=a._authScope.split(xc);if(typeof c===b)c=c.split(xc);d.normalizedScope=Ce(e,c).join(" ")}function Rd(a,b){return new Mb(xe,a.normalizedScope,a,b)}function pd(c,b){return new Mb(M,a._authScope,c,b)}a.canLogout=function(){return Windows.Security.Authentication.OnlineId.OnlineIdAuthenticator().canSignOut};function be(a){try{var c=Windows.Security.Authentication.OnlineId,b=new c.OnlineIdAuthenticator,d=b.signOutUserAsync().then(a,a)}catch(e){H(e);O(a)}}a.ui=function(a){t("WL.ui");if(a.name===Pb)new D(a)};function Yc(a){n(a,[{name:W,allowedValues:[fb,Hd],type:b,optional:true},{name:K,allowedValues:[Wd,ke,de,Ac,X],type:b,optional:true}],"WL.ui-signin");a[W]=a[W]||fb;a[K]=a[K]||Ac}function xd(a){var b=a[K],f=a[W],e=jd(b,f),d=kd(b),c='<button style="text-align: center;">'+e+d+"</button>";return c}function jd(a,d){var b="";if(a!==X){var c=a+(d===fb?"_white.png":"_black.png");b='<img alt="" src="'+Oc()+"/SignInControl/"+c+'" style="vertical-align: middle;">'}return b}function kd(a){var b=a!==X?'<span style="margin: 0px 4px; text-align: center; vertical-align: middle;"></span>':"";return b}D.prototype.updateUI=function(c,e){if(this._element.childNodes.length==0){pb(this);return}var b=this._element.childNodes[0];b.disabled=e&&!a.canLogout();if(c!=this._text){var d=this._properties[K]===X?b:b.childNodes[1];te(d,c);this._text=c}};D.prototype.onMouseDown=function(){this.mousedown=true;ab(this)};D.prototype.onMouseUp=function(){this.mousedown=false;ab(this)};D.prototype.onMouseEnter=function(){this.mousein=true;ab(this)};D.prototype.onMouseLeave=function(){this.mousein=false;ab(this)};function ab(a){var c=a._properties,d=c[K];if(d===X)return;if(a._element.childNodes.length==0){pb(a);return}var g=a._element.childNodes[0].childNodes[0],h=c[W],b=h===fb,f=a.mousedown&&a.mousein;b=f?!b:b;var e=d+(b?"_white.png":"_black.png");g.src=Oc()+"/SignInControl/"+e}function ed(a,b){a._button=b;b.addEventListener("click",S("click",a,a.onClick),false);b.addEventListener("mouseenter",S("mouseenter",a,a.onMouseEnter),false);b.addEventListener("mouseleave",S("mouseleave",a,a.onMouseLeave),false);document.addEventListener("mousedown",S("mousedown",a,a.onMouseDown),false);document.addEventListener("mouseup",S("mouseup",a,a.onMouseUp),false)}function pb(a){var b=a._button;if(b){b.removeEventListener("click",T("click",a),false);b.removeEventListener("mouseenter",T("mouseenter",a),false);b.removeEventListener("mouseleave",T("mouseleave",a),false);document.removeEventListener("mousedown",T("mousedown",a),false);document.removeEventListener("mouseup",T("mouseup",a),false);delete a._button}}var Mb=function(b,f,c,d){var a=this;a._display=b;a._completed=false;a._requestFired=false;a._properties=c;a._callback=d;a._scope=f;var e=b===M?"WL.login":"WL.getLoginStatus";a._promise=new g(e,null,null)};Mb.prototype={execute:function(){return this._sendRequest(this._scope)},_sendRequest:function(b){var a=this,d=v(a,a._onResponse),c=Windows.Security.Authentication.OnlineId,e=a._display===M?c.CredentialPromptType.doNotPrompt:c.CredentialPromptType.promptIfNeeded;a._currentScope=b;he(e,b,d);return a._promise},_onResponse:function(b){var a=this;if(a._display===M&&b[k]===J&&a._currentScope!==E)a._sendRequest(E);else a._onComplete(b)},_onComplete:function(b){var e=this;if(!e._completed){e._completed=true;if(e._display===M&&e._scope===E&&(b[k]===J||b[k]===xb)){var g=b[k]===J?le:mb;a._session.updateStatus(g)}else a._session.onAuthResponse(b);var f=false,d=a._session.getStatus();if(this._display!==M)if(b[c]==null){f=true;d=b}else a._authScope=this._scope;else if(b[k])switch(b[k]){case xb:case J:break;default:f=true;d=b}this._callback(this._properties,d);if(f)this._promise[m](d);else this._promise[h](d)}}};function he(m,n,b){var d="The authentication process failed with error: ",e=" To configure your app correctly, please follow the instructions on http://go.microsoft.com/fwlink/?LinkId=220871.",i=-2147023579,h=-2138701812,l=-2138701821,k=-2138701823;try{var g=a._authMethod?a._authMethod:je;g(m,n,"DELEGATION").then(function(l){var i=l.tickets[0].value,h=null;if(i&&i!=="")if(a._domain)g(Windows.Security.Authentication.OnlineId.CredentialPromptType.doNotPrompt,a._domain,"JWT").then(function(a){var d=a.tickets[0].value;h={};h[c]=i;h[w]=d;j(b,h,false)},function(a){var c=f,g=d+a.message;if(a.name==="WinRTError"&&a.number===k){c=jc;g+=e}h=hb(c,g);j(b,h,false)});else{h={};h[c]=i}else h=hb(f,d+"Unable to get access token.");if(h)j(b,h,false)},function(c){var a=f,g=d+c.message;switch(c.name){case "Canceled":a=J;break;case "WinRTError":switch(c.number){case i:a=xb;break;case h:a=J;break;case l:a=jc;g+=e;break;default:a=f}}var k=hb(a,g);j(b,k,false)})}catch(p){var o=hb(f,d+p.message);j(b,o,false)}}function je(c,f,e){var a=Windows.Security.Authentication.OnlineId,b=new a.OnlineIdAuthenticator,d=new a.OnlineIdServiceTicketRequest(f,e);return b.authenticateUserAsync([d],c)}var Qc=function(b){var a=this;a._state={};a._state[Nc]=b;a._state[F]=mb;a._state[c]=null;O(function(){a.init()})};Qc.prototype={init:function(){a.getLoginStatus({internal:true},true)},isSignedIn:function(){return this._state[F]===L},getStatus:function(){var a=null,b=this._state[F];if(b===L){a={};a[c]=this._state[c];a[w]=this._state[w]}return {status:b,session:a}},getNormalStatus:function(){return this.getStatus()},updateStatus:function(a){var b=this._state[F],e=this._state[c];if(b!=a){this._state[F]=a;this._stateDirty=true;this.onStatusChanged(b,a);if(e!=this._state[c])d.notify(tb,this.getNormalStatus())}},tryGetResponse:function(){return null},onAuthResponse:function(i){var g=false,a=this._state,h=a[F],b=i[c],e=i[w];if(b&&a[c]!=b||e&&a[w]!=e){a[c]=b;a[w]=e;g=true}var f=a[c]?L:mb;if(h!=f){this._statusChecked=true;a[F]=f;this.onStatusChanged(h,f)}if(g)d.notify(tb,this.getNormalStatus())},onStatusChanged:function(b,a){x("AuthSession: Auth status changed: "+b+"=>"+a);if(b!=a){var f=b==L,e=a==L;if(!e)if(this._state[c])delete this._state[c];if(b!=a)d.notify(bc,this.getStatus());if(e!=f)if(e)d.notify(Cb,this.getStatus());else d.notify(Ab,this.getStatus())}}};function ae(b){var c=function(){Kd(b)};a.getLoginStatus({internal:true,callback:c})}function Ge(){return true}function zc(){return a._settings[a._env][Ic]}function md(a){var c=a[p];n(a,[{name:u,type:b,optional:false},{name:eb,type:P,optional:true},y],c);if(a[eb]&&!(a[eb]instanceof Windows.Storage.StorageFile))throw new Error(c+": unsupported file_output object type")}function me(b){var a=b._properties,d=a[u],c=a[eb];cd(d,c,b)}function cd(b,g,a){var e=Ib(b)?b:ec(b),f=new Windows.Foundation.Uri(e);try{var c=new Windows.Networking.BackgroundTransfer.BackgroundDownloader;c.group=vc;var h=c.createDownload(f,g),d=h.startAsync().then(function(b){var c={content_type:b.getResponseInformation().headers.lookup("Content-Type"),stream:b.getResultStreamAt(0)};a.downloadComplete(true,c)},function(b){Vb(b.message,a)},function(d){var b=d.progress,c={bytesTransferred:b.bytesReceived,totalBytes:b.totalBytesToReceive,progressPercentage:b.totalBytesToReceive==0?0:b.bytesReceived/b.totalBytesToReceive*100};a.downloadProgress(c)});a._cancel=v(d,d.cancel)}catch(i){Vb(i.message,a)}}Fb.prototype._getStrategy=function(a){var c=a[p],b=a[oc],d=a[Ed];if(b)if(b instanceof Windows.Storage.StorageFile)return new Rb(this,b);else throw new Error(c+": unsupported file_input object type");else if(d)return new Rb(this,d);else throw new Error(c+": file_input or stream_input must be specified.")};function Rb(a,b){this.upload=function(i){var h=new Windows.Foundation.Uri(i),c=new Windows.Networking.BackgroundTransfer.BackgroundUploader,g=function(f){var c="",d=f.getResultStreamAt(0);if(d){var b=new Windows.Storage.Streams.DataReader(d),e=function(d){if(d)c=b.readString(d);a.onResp(c);b.close()};b.loadAsync(100000).then(e,e)}else a.onResp(c)},d=function(b){a.onErr(b.message)},f=function(d){var b=d.progress,c={bytesTransferred:b.bytesSent,totalBytes:b.totalBytesToSend,progressPercentage:b.totalBytesToSend==0?0:b.bytesSent/b.totalBytesToSend*100};a.uploadProgress(c)},e=function(b){try{b()}catch(c){a.onErr(c.message)}};c.group=Ec;c.method=ne;e(function(){var i;if(b instanceof Windows.Storage.StorageFile)i=c.createUpload(h,b).startAsync().then(g,d,f);else i=c.createUploadFromStreamAsync(h,b).then(function(b){e(function(){i=b.startAsync().then(g,d,f);a._cancel=v(i,i.cancel)})},d);a._cancel=v(i,i.cancel)})}}function rc(a){var b=document.readyState;if(b==="complete"||document.body!==null)a();else window.addEventListener("DOMContentLoaded",a,false)}function ye(b,a){MSApp.execUnsafeLocalFunction(function(){b.innerHTML=a})}a[z]="Windows/HTML8_"+Cd("5.2.3370.0802");if(!a._settings)a._settings={};var He=a._settings,Kb={},De="login.live.com";Kb[Ic]="https://apis.live.net/v5.0/";Kb[Pc]=De;He["PROD"]=Kb;a._env="PROD";a.onloadInit()}})();